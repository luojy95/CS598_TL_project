# CS598_TL_project
## Fall 2021 CS598 Transfer Learning Class Project

## Aurthor
[Jiayi Luo](github.com/luojy95/)

## Reference
- [Rectifying pseudo label learning via uncertainty estimation for domain adaptive semantic segmentation](https://arxiv.org/abs/2003.03773)

- [A simple framework for contrastive learning of visual representations](https://arxiv.org/abs/2002.05709)

- [Learning to adapt structured output space for semantic segmentation](https://arxiv.org/abs/1802.10349)

- [SSF-DAN: Separated Semantic Feature based Domain Adaptation Network for
Semantic Segmentation](https://openaccess.thecvf.com/content_ICCV_2019/papers/Du_SSF-DAN_Separated_Semantic_Feature_Based_Domain_Adaptation_Network_for_Semantic_ICCV_2019_paper.pdf)

- [Unsupervised scene adaptation with memory regularization in vivo](https://arxiv.org/abs/1912.11164)

- [CARLA: An open urban driving simulator](https://carla.org/)

- [Contrastive Learning for Label Efficient Semantic Segmentation](https://arxiv.org/abs/2012.06985)

- [Momentum contrast for unsupervised visual representation learning](https://arxiv.org/abs/1911.05722)

### *The training process consists of three steps:*

- Step I (Training Stage I): Train the model using the synthetic data, generated by CARLA simulator.

- Step II: Generate Pseudo Label using the trained model for the real data.

- Step III (Training Stage II): Train the model using the real data with the pseudo label.

### Training Stage I

    cd CLRM_Net && python train_ms_custom.py --snapshot-dir ./snapshots/_SE_GN_batchsize2_1024x512_pp_ms_me0_classbalance7_kl0.1_lr2_drop0.1_seg0.5  --drop 0.1 --warm-up 5000 --batch-size 2 --learning-rate 2e-4 --crop-size 1024,512 --lambda-seg 0.5  --lambda-adv-target1 0.0002 --lambda-adv-target2 0.001   --lambda-me-target 0  --lambda-kl-target 0.1  --norm-style gn  --class-balance  --only-hard-label 80  --max-value 7  --gpu-ids 0,1  --often-balance  --use-se  

### Pseudo Label Generation

    cd CLRM_Net && python generate_plabel_custom.py  --restore-from ./snapshots/SE_GN_batchsize2_1024x512_pp_ms_me0_classbalance7_kl0.1_lr2_drop0.1_seg0.5/GTA5_25000.pth
  
### Training Stage II

    cd CLRM_Net && python train_ft_custom.py --snapshot-dir ./snapshots/1280x640_restore_ft_GN_batchsize9_512x256_pp_ms_me0_classbalance7_kl0_lr1_drop0.2_seg0.5_BN_80_255_0.8_Noaug --restore-from ./snapshots/SE_GN_batchsize2_1024x512_pp_ms_me0_classbalance7_kl0.1_lr2_drop0.1_seg0.5/GTA5_25000.pth --drop 0.2 --warm-up 5000 --batch-size 9 --learning-rate 1e-4 --crop-size 512,256 --lambda-seg 0.5 --lambda-adv-target1 0 --lambda-adv-target2 0 --lambda-me-target 0 --lambda-kl-target 0 --norm-style gn --class-balance --only-hard-label 80 --max-value 7 --gpu-ids 0,1,2 --often-balance  --use-se  --input-size 1280,640  --train_bn  --autoaug False

